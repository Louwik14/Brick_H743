Pipeline:
- Selection MUX via S0/S1/S2 communs, settling puis conversions ADC1/ADC2 pour chaque position.
- Filtrage moyenne glissante taille fixe (factor) par canal avant traitement.
- Calibration dynamique min/max par canal avec deadzone centrale dérivée de l’étendue.
- Normalisation 0..127 avec interpolation sur la deadzone pour éviter le clamp.
- Hystérésis press/release (seuil bas/haut) avec détection de fronts.
- Vélocité calculée sur traversée du couple de seuils (temps entre start_th et end_th).
- Exposition des valeurs brutes, normalisées, vélocité et état pressed.

Filtrage:
- Buffer circulaire par canal (factor échantillons, borné à BRICK_ASC_MAX_FACTOR).
- Somme cumulée mise à jour en O(1) (soustraction ancien, ajout nouveau).
- Moyenne = sum / count (count saturé à factor). Sortie valide dès count==factor.

Vélocité:
- Armement quand l’échantillon descend sous start_th en provenance d’une valeur supérieure.
- Capture du temps système à l’armement.
- Quand l’échantillon franchit end_th, dt = now-start, saturé entre HALL_VELOCITY_MIN_US et HALL_VELOCITY_MAX_US.
- Mapping linéaire inverse: velocity = (HALL_VELOCITY_MAX_US - dt) * 127 / (span).
- Désarmement si retour au-dessus de start_th avant validation (rejets bruit).

Calibration:
- Tableau statique par capteur pour min/max/detent_low/detent_high/enable.
- Mise à jour min/max à chaque échantillon actif.
- Deadzone recalculée automatiquement autour du centre (range/HALL_DETENT_DEN).
- Aucune allocation dynamique, aucune logique potentiomètre externe.

Limites connues:
- Vélocité linéaire, dépend fortement des seuils press/release fixés.
- Min/max dérivent lentement si dérive ADC permanente (pas de fenêtre temporelle).
- Deadzone fixe proportionnelle à la plage, non configurable à chaud.

Hypothèses matérielles:
- STM32H743 avec deux ADC indépendants (lignes PC4 et PA7) et deux MUX 8 voies.
- Lignes S0/S1/S2 communes (PA5/PA4/PA6) pilotent les deux MUX.
- Résolution ADC 12 bits, cadence tâche suffisante pour ~2 kHz post-mux.

Rôle des fichiers:
- brick_asc.c/.h : filtre moyenne glissante statique, buffer circulaire.
- brick_cal.c/.h : calibration min/max et gestion deadzone statique pour les capteurs Hall.
- drv_hall.c/.h : pilotage MUX+ADC, filtrage, calibration, normalisation, vélocité, hystérésis et API publique.
